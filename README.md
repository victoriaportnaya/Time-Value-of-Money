# Фінансова математика в Python

### Навіщо це все треба, є ж Excel?

Так, Excel дійсно є, і часто використовувати саме його для фінансових обчислень може бути простіше. Але не забувайте Ваші **hard skills** і **CV**. Рядок "Фінансовий аналіз у Python" виглядає явно краще, ніж "фінансовий аналіз в Excel" для вашого потенційного роботодавця, погодьтеся? Ба більше, вміння використовувати Python для найрізноманітніших завдань загалом робить вас більш конкурентоспроможним аналітиком, здатним справлятися зі складнішими завданнями.


### Імпорт бібліотеки

Для того, щоб почати роботи з потрібними нам функціями, спочатку потрібно імпортувати дві *бібліотеки*: **Numpy** (загалом, вона використовується для математичних операцій з матрицями) та її спеціально розроблену для фінансових застосувань підбібліотеку: **numpy_financial**.
<br>
<br>
**Зауваження!** Оскільки потрібна нам бібліотека не є "базовою", перед імпортом потрібно використовувати pip (завантажити її).


```python
pip install numpy-financial
```

    Requirement already satisfied: numpy-financial in c:\users\victo\anaconda3\lib\site-packages (1.0.0)
    Requirement already satisfied: numpy>=1.15 in c:\users\victo\anaconda3\lib\site-packages (from numpy-financial) (1.24.3)
    Note: you may need to restart the kernel to use updated packages.
    


```python
import numpy as np 
import numpy_financial as npf 
```

### Процентна ставка 

Припустимо, що ми маємо такі дані про кількість періодів, періодичний платіж, PV і FV. На основі них ми хочемо розрахувати **процентну ставку**.


```python
periods = 12
payment = 1500
pv = 500
fv = 300
```

Для розрахунку ефективної процентної ставки ми використовуємо функцію **npf.rate()**. Як **обов'язкові** аргументи вводимо: 
1. **nper** - кількість періодів (scalar або array)
2. **pmt** - виплата (scalar або array)
3. **pv** - present value (scalar або array)
4. **fv** - future value (scalar або array)
І *опціональні* аргументи, які можуть стати в пригоді:
5*) *when*: коли відбувається оплата - наприкінці періоду (0) або на початку (1).


```python
rate = npf.rate(periods, payment, pv, fv)
print(rate)
```

    -2.1436255592964812
    

### Internal Return Rate (IRR)

Тепер нехай у нас є така інформація: початкова інвестиція (яку ми записуємо зі знаком "-"), і грошовий потік у форматі. Записуємо їх в list [ ]. Наше завдання - розрахувати **IRR**.


```python
initial_investment = -10000
cash_flow = [initial_investment, 1500, 2500, 3000, 5000, 4000, -1000, -2000, 3500]
```

Для розрахунку IRR ми будемо використовувати функцію **np.irr()**. Як єдиний аргумент - *cash flow*.


```python
irr = npf.irr(cash_flow)
print(irr) # формат float, тобто щоб отримати %, можна помножити на 100
```

    0.14913720237912864
    

### Приведення вартості: Present Value & Future Value

#### Present Value

Для розрахунку PV (present value) використовуємо функцію **npv.pv()**. На вхід вона приймає **обов'язкові** аргументи:
1. **rate** - процентна ставка на **період** (array / scalar)
2. **nper** - кількість періодів (array / scalar)
3. **pmt** - регулярний платіж (array / scalar)
І *опціональні* аргументи: 
4*) *fv* - future value (array / scalar)
5*) *when* - на який момент платіж (початок періоду - 1, кінець - 0).

<br> **Зауваження!** Якщо далі платежі не здійснюються і знаємо тільки FV, то записуємо pmt = 0 і далі вносимо аргумент fv.

**Розглянемо приклад**
<br>
Яка PV (наприклад, початкова інвестиція) інвестиції, яка повинна скласти 350000 грн. після 10 років заощаджень по 2000 грн щомісяця?
<br> Припустимо, що відсоткова ставка становить 5% (річних) з щомісячним нарахуванням.
<br> **Перепишемо дані у вигляді аргументів і скористаємося функцією.**


```python
rate = 0.05 # не забуваємо про формат float! розділимо далі на 12, щоб отримати rate per period
nper = 10 # оскільки платежі щомісячні, далі помножимо на 12, щоб отримати потрібну кількість періодів
pmt = -200 
fv = 350000 

pv = npf.pv(rate/12, nper*12, pmt, fv)
print(pv)
```

    -193650.09403901073
    

#### Future Value

Майже аналогічно, для розрахунку FV (future value) використовуємо функцію **npv.fv()**. На вхід вона приймає **обов'язкові** аргументи:
1. **rate** - процентна ставка на **період** (array / scalar)
2. **nper** - кількість періодів (array / scalar)
3. **pmt** - регулярний платіж (array / scalar)
4) **pv** - present value (array / scalar) **тут Present Value - обов'язковий аргумент!**
<br> <br>**Зауваження!** Якщо далі платежі не здійснюються, тільки початковий платіж (PV), то pmt = 0.


**Розглянемо приклад**
<br> Якою буде FV через 10 років, якщо заощаджувати 5000 грн. зараз і додатково відкладати по 150 грн. щомісяця. 
<br> Припустимо, що відсоткова ставка становить 6% (річних) з щомісячним нарахуванням?
<br> **Перепишемо дані у вигляді аргументів і скористаємося функцією.**


```python
rate = 0.06 # не забуваємо про формат float! розділимо далі на 12, щоб отримати rate per period
nper = 10 # оскільки платежі щомісячні, далі помножимо на 12, щоб отримати потрібну кількість періодів
pmt = -150 
pv = 5000 

fv = npf.fv(rate/12, nper*12, pmt, pv)
print(fv)
```

    15484.918350807255
    

### Чиста поточна вартість: Net Present Value

Тут усе дуже просто. Як нескладно здогадатися, ми використовуємо функцію **npf.npv()**. Є тільки два аргументи: 
1. **rate** - ставка дисконтування
2. **values** - грошовий потік у форматі list [ ].


**Розглянемо приклад**
<br> Проаналізуємо потенційний проект з початковою інвестицією 100 000 грн. і прогнозованими грошовими потоками 50 000, 8 000, 15000 і 60 000 в кінці кожного періоду, дисконтованими за ставкою 7% за період. Знайти NPV.
<br> **Перепишемо дані у вигляді аргументів і скористаємося функцією.**


```python
rate = 0.07
cash_flow = [-100000, 50000, 8000, 15000, 60000]

npv = npf.npv(rate, cash_flow)
print(npv)
```

    11734.662665016804
    

### Ануїтетний платіж


```python

```
